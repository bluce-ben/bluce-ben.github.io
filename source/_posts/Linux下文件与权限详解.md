---
title: Linux下文件与权限详解
date: 2017-12-25 14:48:56
categories:
- Linux
tags:
- Linux
---
　　首先，需要知道的是，“Linux下一切皆档案”。且Linux一般将档案可存取的身份分三个类别，分别是 owner/group/others，且三种身份各有 read/write/execute 等权限。
（注：对应的档案存储文件为： 用户记录在 /etc/passwd 档案； 用户密码记录在 /etc/shadow 档案；组名记录在 /etc/group 档案。）
- 所有者（owner）：
一般为文件的创建者，谁创建了该文件，就天然的成为该文件的所有者。（使用chown修改文件的所有者）
- 文件所在组（group）：
当某个用户创建了一个文件后，这个文件的所在组就是该用户所在的组。（使用chgrp修改文件所在的组）
- 其它人（others）：
除开文件的所有者和所在组的用户外，系统的其它用户都是文件的其它组
<!--more-->
### 档案信息详解
由命令 ls -al查看档案的所有信息：
```
-rw-r--r-- 1 root root 42304 Dec 25 17:26 install.log <=范例说明处
[权限] [链接数] [拥有者] [群组] [档案容量] [修改日期] [档名]
```
1. 第一栏代表这个档案的类型与权限(permission)：
第一个字符代表这个档案是『目录、档案或链接文件等等』：
  * 当为[ d ]则是目彔，例如上表档名为『.gconf』的那一行；
  * 当为[ - ]则是档案，例如上表档名为『install.log』那一行；
  * 若是[ l ]则表示为链接档(link file)；
  * 若是[ b ]则表示为装置文件里面的可供储存的接口设备(可随机存取装置)；
  * 若是[ c ]则表示为装置文件里面的串行端口设备，例如键盘、鼠标(一次性读取装置)。
（其余字符没3个为一组，分别对应所有者、所属组、其他人。）
2. 第二栏表示有多少档名链接到此节点(i-node，即是索引节点)：
每个档案都会将他的权限与属性记录到文件系统的i-node 中，不过，我们使用的目录树却是使用文件名来记录， 因此每个档名就会连结到一个i-node！这个属性记录的，就是有多少不同的档名连结到相同的一个i-node 号码去就是了。
3. 第三栏表示这个档案(或目录)的『拥有者账号』
4. 第四栏表示这个档案的所属群组
5. 第五栏为这个档案的容量大小，默认单位为bytes；
6. 第六栏为这个档案的建档日期或者是最近的修改日期：
7. 第七栏为这个档案的档名

### 改变档案属性与权限命令
1、chgrp（change group）：改变档案所属群组
语法：`chgrp [-R] dirname/filename ...`
选项与参数：
-R : 进行递归(recursive)的持续变更，亦即连同次目录下的所有档案、目录都更新成为这个群组之意。常常用在变更某一目录内所有的档案之情况。
范例：
`[root@www ~]# chgrp users install.log`
2、chown（change owner）：改变档案拥有者
语法：`chown [-R] 账号名称[:组名] 档案或目录`
选项与参数：
-R : 进行递归(recursive)的持续变更，亦即连同次目录下的所有档案都变更
范例：将install.log 的拥有者改为bin 这个账号：
`[root@www ~]# chown bin install.log`
3、chmod ：改变档案的权限, SUID, SGID, SBIT 等等的特性
语法：`chmod [-R] xyz 档案或目录`
选项与参数：
xyz : 就是刚刚提到的数字类型的权限属性，为 rwx 属性数值的相加。
-R : 进行递归(recursive)的持续变更，亦即连同次目录下的所有档案都会变更

1. 数字类型改变档案权限
我们可以使用数字来代表各个权限，各权限的分数对照表如下：
r:4
w:2
x:1
`[root@www ~]# chmod 777 .bashrc`
2. 符号类型改变档案权限
基本上就九个权限分别是(1)user (2)group (3)others 三种身份。那么我们就可以藉由u, g, o 来代表三种身份的权限！此外，a 则代表 all 亦即全部的身份！那么读写的权限就可以写成r, w, x。
![](/uploads/2017/12/linux_permission_01.png)
假如我们要『限定』一个档案的权限成为『-rwxr-xr-x』时，基本上就是：
	user (u)：具有可读、可写、可执行的权限；
	group 不 others (g/o)：具有可读不执行的权限。
`[root@www ~]# chmod u=rwx,go=rx .bashrc`
*注意：那个 u=rwx,go=rx 是连在一起的，中间并没有任何空格符！*

### 权限对于文件与目录的作用
#### 1、权限对文件的重要性：
权限对于档案来说，他的意义是这样的：

	1. r (read)：可读取此一档案的实际内容，如读取文本文件的文字内容等；
	2. w (write)：可以编辑、新增或者是修改该档案的内容(但不能删除该档案)；
	3. x (eXecute)：该档案具有可以被系统执行的权限。
　　Windows 底下一个档案是否具有执行的能力是藉由『 扩展名 』来判断的， 例如：.exe, .bat, .com 等等，但是在Linux 底下，我们的档案是否能被执行，则是藉由是否具有『x』这个权限来决定的！跟档名是没有绝对的关系的！

#### 2、权限对目录的重要性：
目录主要的内容在记录文件名列表，文件名与目录有强烈的关连！所以如果是针对目录时，那个 r, w, x 对目录意义是这样的：
	1. r (read contents in directory)：
	表示具有读取目录结构列表的权限，如利用 ls 这个指令将该目录的内容列表显示出来；
	2. w (modify contents of directory)：
	表示你具有异动该目录结构列表的权限，也就是底下这些权限：
		* 建立新的档案与目录；
		* 删除已经存在的档案与目录(不论该档案的权限为何！)
		* 将已存在的档案或目录进行更名；
		* 搬移该目录内的档案、目录位置。
	3. x (access directory)：
	目录只是记录文件名而已，不可以被执行，目彔的x 代表的是用户能否进入该目录成为工作目录的用途。

### Linux档案种类与扩展名
##### 1、档案种类：
我们在刚刚提到使用『ls -l』观察到第一栏那十个字符中，第一个字符为档案的类型。 除了常见的一般档案(-)与；目录档案(d)之外，还有哪些种类的文件类型呢？
（1）正规档案(regular file )：
在由 ls -al 所显示出来的属性方面，第一个字符为 [-]，例如 [-rwxrwxrwx ]。另外，依照档案的内容，又大略可以分为：
> 1、纯文本档(ASCII)：这是Linux 系统中最多的一种文件类型， 称为纯文本档是因为内容为我们人类可以直接读到的数据，例如数字、字母等等。
> 2、二进制文件(binary)：你的Linux当中的可执行文件(scripts, 文字型批处理文件不算)就是这种格式。举例来说，刚刚下达的指令cat 就是一个binary file。
> 3、数据格式文件(data)：有些程序在运作的过程当中会读取某些特定格式的档案，那些特定格式的档案可以被称为数据文件 (data file)。

（2）目录(directory)：
就是目录，第一个属性为 [ d ]，例如 [drwxrwxrwx]。
（3）链接档(link)：
就是类似Windows 系统底下的快捷方式，第一个属性为 [ l ](英文L 的小写)，例如[lrwxrwxrwx] ；
（4）设备与装置文件(device)：
与不系统周边及储存等相关的一些档案，通常都集中在/dev 这个目录之下！通常又分为两种：
> 1、区块(block)设备档 ：就是一些储存数据，以提供系统随机存取的接口设备，举例来说，硬盘与软盘等。你可以自行查一下/dev/sda 看看， 会发现第一个属性为[ b ]。
> 2、字符(character)设备文件：亦即是一些串行端口的接口设备，例如键盘、鼠标等等。第一个属性为 [ c ]。

（5）资料接口文件(sockets)：
既然被称为数据接口文件，这种类型的档案通常被用在网络上的数据承接。第一个属性为 [ s ]， 最常在/var/run 这个目录中看到这种文件类型了。
（6）数据输送文件(FIFO, pipe)：
FIFO 也是一种特殊的文件类型，他主要的目的在解决多个程序同时存取一个档案所造成的错误问题。FIFO 是first-in-first-out 的缩写。第一个属性为[p] 。

##### 2、Linux 档案扩展名：
基本上，Linux 的档案是没有所谓的『扩展名』的，我们刚刚就谈过，一个Linux 档案能不能被执行，与他的第一栏的十个属性有关， 与文件名根本一点关系也没有。
通常我们还是会以适当的扩展名来表示该档案是什么种类的。底下有数种常用的扩展名：
> 1、\*.sh ： 脚本或批处理文件 (scripts)，因为批处理文件为使用shell 写成的，所以扩展名就编成 .sh；
> 2、\*Z, \*.tar, \*.tar.gz, \*.zip, \*.tgz： 经过打包的压缩文件。这是因为压缩软件分别为 gunzip, tar 等等的，由与不同的压缩软件，而取其相关的扩展名啰！
> 3、\*.html, \*.php：网页相关档案，分别代表 HTML 语法与 PHP 语法的网页档案。

##### 3、Linux 文件名的限制：
由于Linux 在文字接口下的一些指令操作关系，一般来说，你在设定Linux 底下的文件名时， 最好可以避免一些特殊字符比较好！例如底下这些：
\* ? > < ; & ! [ ] | \ ' " ` ( ) { }
因为这些符号在文字接口下，是有特殊意义的。