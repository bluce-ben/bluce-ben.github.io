---
title: 总结-MySQL数据库设计
date: 2017-12-08 13:13:28
categories:
- MySQL
tags:
- MySQL
---
## 一、什么是数据库设计
**１、数据库设计概念**
　数据库设计就是根据业务系统的具体需求，结合所选择的DBMS，为这个业务系统构造出最优的数据存储模型。并建立好数据库中表的结构，以及表与表之间的关联关系的过程。使之能有效的对应用系统中的数据进行存储，并可以高效的对已经存储的数据进行查询访问。
**２、设计对比**

优良的设计		|  槽糕的设计
----------------|---------------------------------
减少数据冗余	| 存在大量的数据冗余
避免数据维护异常| 存在数据插入、更新、删除异常
节约存储空间(偶尔会用空间换时间) | 浪费大量存储空间
高效的访问		| 访问数据低效
<!--more-->
## 二、数据库设计的步骤
**1). 需求分析**
　需求分析主要完成的内容：业务系统中有哪些数据？这些数据又有哪些属性？数据和属性的各自特点有哪些？ 
**2). 逻辑设计**
　使用ER图设计工具对数据库进行ER图逻辑建模：首先将需求转化为数据库的逻辑模型，其次，通过ER图形式将逻辑模型描述展示出来，最后这个逻辑设计与所选择的DBMS无关，也就是说这个逻辑设计应该适合所有的DBMS。 
**3). 物理设计**
　这个阶段是进入到与DBMS相关的阶段，因此首先需要选择DBMS，并且将第二步的逻辑模型转为物理模型。 
　这个阶段会涉及到数据库中建表，选择字段类型的问题。在MySQL中遵循以下原则： 
　列的数据类型一方面影响相应数据的存储空间的开销，另一方面也会影响数据查询性能。当一个列可以选择多种数据类型时，应该优先考虑数字类型，其次是日期或二进制，最后是字符串类型。对于相同级别的数据类型，在满足业务的情况下，应该优先选择占用空间小的数据类型。 
　mysql中部分字段空间占用情况： 
![](/uploads/2017/12/mysql_database_01.jpg) 
*额外注意几点：*
* 在对数据进行比较(where、join 、order by)操作时，同样的数据，字符串处理比数字处理更慢。
* 在MySql中，UTF-8占用3个字节。

**4). 维护优化**
* 针对新的需求建立新的数据库表(这里补充说明下，在进行数据库最初的设计过程中，不建议在表中预留不确定的字段，这并不能实现数据库良好的扩展性问题，它的代价与后期新加一个字段一样，甚至更大)
* 索引优化
* 大表拆分：拆分又分为两种方式 
  * 水平拆分：控制表的长度，即数据的行数。会将每个表中的数据量减少。
  * 垂直拆分：数据库中的存储是以页为单位的，当每一行的宽度比较小时(列数比较少时)，每页中存储的内容就多，IO效率就高(数据中的数据是存放在磁盘上，每次IO的内容越多越好)。因此常常对于非常宽的表，进行表的垂直拆分。拆表后的数据量不应该发生变化，但是表的数量增加，每张表的宽度减少。

## 三、数据库中的几大范式
**第一范式(1NF)**
>概念：数据库表中的所有字段值都是不可分解的原子值，就说明该数据库表满足了第一范式。 
>作用：确保每列保持原子性 （每个表中的字段不可再拆分）
>举例：本来正常情况下，设计地址，只需要一个字段，但是若在实际业务系统中需要访问其中的国家、省、市时，此时就应该将地址这个字段进行拆分才符合1NF。

**第二范式(2NF)**
>概念：基于1NF基础之上，第二范式需要确保数据库表中的每一列都和主键相关，而不能只与主键的某一部分相关（主要针对联合主键而言）。也就是说在一个数据库表中，一个表中只能保存一种数据，不可以把多种数据保存在同一张数据库表中。此外：所有单关键字段的表都符合第二范式。 
>作用：确保表中的每列都和主键相关（一个表中只能有一个主键）

**第三范式(3NF)**
>概念：基于2NF基础上的，如果数据表中不存在非关键字段对任意候选关键字段的传递函数依赖则符合第三范式。 
>作用：确保每列都和主键列直接相关,而不是间接相关 （表中字段都与主键直接相关）

## 四、高手的境界都是无招胜有招
　为了设计出优良的数据库，我们需要遵循数据库的范式，但是有时候如果你设计的数据库完全遵循了这些范式，反而会降低你的某些性能。这里提几点： 
- 数据库连接会带来一部分性能损失，因此有时候为了减少冗余，将数据存放在多张表中，往往会降低查询性能，而互联网的世界，读写比例大概是3:1甚至4:1 
- 减少表与表之间的关联数量(减少了对磁盘的IO)，增加数据的读取效率。 
- 反范式化一定要适度。凡事过度适得其反。
