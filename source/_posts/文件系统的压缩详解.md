---
title: 文件系统的压缩详解
date: 2017-12-27 13:58:23
categories:
- 书籍
- 《鸟哥的Linux私房菜基础篇（第三版）》
tags:
- 书籍
- 计算机系统
---
何为压缩？
何为压缩比？
为什么要压缩，压缩有什么好处？
带着这几个问题我们来学习一下。
<!--more-->
### 1、为什么要压缩：
如果一个软件档案很多，或者文件档案太大，都会耗掉很多的磁盘空间，如果是网络传输也会耗掉很多带宽和时间，同时也不利于复制与携带。此时就需要【文件压缩】技术了。

### 2、压缩的好处：
透过文件压缩的技术，最大的好处就是压缩过的档案容量变小了， 所以你的硬盘容量无形之中就可以容纳更多的资料。此外，在一些网络数据的传输中，也会由于数据量的降低，好让网络带宽可以用来作更多的工作。目前很多的 WWW 网站也是利用文件压缩的技术来进行数据的传送，好让网站带宽的可利用率上升。

### 3、压缩的原理：
目前我们使用的计算机系统中都是使用所谓的 bytes（字节） 单位来计量的。不过，事实上，计算机最小的计量单位应该是 bits（比特） 才对。此外，我们也知道 1 byte = 8 bits 。但是如果今天我们只是记忆一个数字，亦即是 1 这个数字？他会如何记录？假设一个 byte 可以看成底下的模样：
　　　□□□□□□□□
*（由于 1 byte = 8 bits ，所以每个 byte 当中会有 8 个空格，而每个空格可以是 0,1）*

由于我们记录数字是 1 ，考虑计算机所谓的二进制，如此一来， 1 会在最右边占据 1 个 bit ，而其他的 7 个 bits 将会自动的被填上 0 。你看看，其实在这样的例子中，那 7 个 bits 应该是【空的】才对。不过，为了要满足目前我们的操作系统数据的存取（按字存取或按字节存取两种），所以就会将该数据转为 byte 的型态来记录。而一些聪明的计算机工程师就利用一些复杂的计算方式，将这些没有使用到的空间【丢】出去，以让档案占用的空间变小。这就是压缩的技术。

另外一种压缩技术也很有趣，他是将重复的数据进行统计记录的。举例来说，如果你的数据为【111....】共有100 个1 时， 那么压缩技术会记录为【100 个1】而不是真的有100 个1 的位存在！这样也能够精简档案记录的容量。

简单的说，你可以将他想成，其实档案里面有相当多的【空间】存在，并不是完全填满的， 而【压缩】的技术就是将这些【空间】填满，以让整个档案占用的容量下降。不过，这些【压缩过的档案】并无法直接被我们的操作系统所使用，因此， 若要使用这些被压缩过的档案数据，则必项将他【还原】回来未压缩前的模样， 那就是所谓的【解压缩】。而至于压缩前与压缩后的档案所占用的磁盘空间大小，就可以被称为是【压缩比】。

### 4、压缩文件扩展名：
在Linux中，文件的扩展名是没什么作用的，但是为什么不同的压缩文件有不同的扩展名呢？原因就是，因为 Linux 支持的压缩指令非常多，且不同的指令所用的压缩技术并不相同，当然彼此之间可能就无法互通压缩/解压缩文件。所以，当你下载到某个压缩文件时，自然就需要知道该档案是由哪种压缩指令所制作出来的，好用来对照着解压缩。也就是说，虽然 Linux 档案的属性基本上是与文件名没有绝对关系的，但是为了帮助我们人类小小的脑袋瓜子，所以适当的扩展名还是必要的。
底下我们就列出几个常见的压缩文件扩展名吧：

	*.Z compress 程序压缩的档案；
	*.gz gzip 程序压缩的档案；
	*.bz2 bzip2 程序压缩的档案；
	*.tar tar 程序打包的数据，并没有压缩过；
	*.tar.gz tar 程序打包的档案，其中并且经过 gzip 的压缩
	*.tar.bz2 tar 程序打包的档案，其中并且经过 bzip2 的压缩

### 5、常用压缩命令
##### 1. tar 命令：
```
语法：语法：tar [主选项+辅选项] 文件或者目录
参  数：
-c: 建立压缩档案
-x：解压
-t：查看内容
-r：向压缩归档文件末尾追加文件 (注：压缩后的档案再次追加文件会导致失败)
-u：更新原压缩包中的文件（注：压缩后的档案再次更新会导致失败）
这五个是独立的命令，压缩解压都要用到其中一个，可以和别的命令连用但只能用其中一个。
下面的参数是根据需要在压缩或解压档案时可选的。
-z：有gzip属性的
-j：有bz2属性的
-Z：有compress属性的
-v：显示所有过程
-O：将文件解开到标准输出
-f：使用档案名字，切记，这个参数是最后一个参数，后面只能接档案名。（必须）
-C：解压到指定目录
特殊使用：
① # tar -rf all.tar *.gif
这条命令是将所有.gif的文件增加到all.tar的包里面去。-r是表示增加文件的意思。
② # tar -uf all.tar logo.gif
这条命令是更新原来tar包all.tar中logo.gif文件，-u是表示更新文件的意思。
③ # tar -tf all.tar
这条命令是列出all.tar包中所有文件，-t是列出文件的意思
压缩：
① tar -cvf jpg.tar *.jpg //仅打包，不压缩！
② tar -zcvf jpg.tar.gz *.jpg   //打包后，以 gzip 压缩
③ tar -jcvf jpg.tar.bz2 *.jpg //打包后，以 bzip2 压缩
解压：
① tar -xvf file.tar //解压 tar包
② tar -zxvf file.tar.gz //解压tar.gz
③ tar -jxvf file.tar.bz2   //解压 tar.bz2
④ tar -xvf archive.tar -C /tmp 将压缩包释放到 /tmp目录下 
```

##### 2. zip 命令：
```
语　　法：zip [-AcdDfFghjJKlLmoqrSTuvVwXyz$][-b <工 作目录>][-ll][-n <字 尾字符串>]\
[-t <日 期时间>][-<压 缩效率>][压 缩文件][文件...][-i <范本样式>][-x <范本样式>]
参　　数：
-r   递归处理，将指定目录下的所有文件和子目录一并处理。
-d   从压缩文件内删除指定的文件。
-D   压缩文件内不建立目录名称。
-m   将文件压缩并加入压缩文件后，删除原始文件，即把文件移到压缩文件中。
-x<范本样式>   压缩时排除符合条件的文件。
-q   不显示指令执行过程。
压缩文件：
①  将当前目录下的所有文件和文件夹全部压缩成test.zip文件,-r表示递归压缩子目录下所有文件
# zip -r test.zip ./*
② 删除压缩文件test1.zip中test.MYI文件
# zip -d test1.zip test.MYI
③ 向压缩文件中test1.zip中添加test. MYI文件
# zip -m test1.zip test. MYI
④ 压缩文件时排除某个文件
# zip test3.zip tests/* -x tests/ln.log
unzip 命令：
语　　法：unzip [-cflptuvz][-agCjLMnoqsVX][-P <密 码>][.zip文 件][文件][-d <目录>][-x <文件>] 或 unzip [-Z]
-v   执 行是时显示详细的信息。或查看压缩文件目录，但不解压。
-n   解 压缩时不要覆盖原有的文件。
-o   不 必先询问用户，unzip执 行后覆盖原有文件。
-q   执 行时不显示任何信息。
-d<目录>   指 定文件解压缩后所要存储的目录。
解压文件：
① 将压缩文件text.zip在当前目录下解压缩。
# unzip test.zip 
② 将压缩文件text.zip在指定目录/tmp下解压缩，如果已有相同的文件存在，要求unzip命令不覆盖原先的文件。
# unzip -n test.zip -d /tmp
③ 查看压缩文件目录，但不解压。
# unzip -v test.zip
④ 将压缩文件test.zip在指定目录tmp下解压缩，如果已有相同的文件存在，要求unzip命令覆盖原先的文件。
# unzip -o test.zip -d tmp/
```